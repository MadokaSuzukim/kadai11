<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Chat App</title>
<link rel="stylesheet" href="style3.css"> 

    <!-- è¨­å®šå†…å®¹ -->
</head>
<body>
    <header>
        <h1>My Self Taik </h1>
    </header>
    <div class="header">
        <h1>è‡ªåˆ†ã¨å¯¾è©±ã‚’ã—ã¦ã¿ã‚ˆã†ğŸ¶</h1>
    </div>
        <div class="section-header">STEP1: ã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯ã‚’æ›¸ãå‡ºã™</div>
        <div class="section-content">
          <p>
            ã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯ã‚’è¡Œã†éš›ã«æ„Ÿã˜ãŸã“ã¨ã‚„æ€ã£ãŸã“ã¨ã‚’ãƒ¡ãƒ¢ã™ã‚‹
            </p><p>è‡ªåˆ†ã®é ­ã®ä¸­ã§ç¹°ã‚Šè¿”ã—è©±ã—ã¦ã„ã‚‹è¨€è‘‰ã‚„è€ƒãˆã‚’æ›¸ãå‡ºã™</p>
        </div>
        <div class="section-header">STEP2: ãƒã‚¬ãƒ†ã‚£ãƒ–ãªã‚‚ã®ã¨ãƒã‚¸ãƒ†ã‚£ãƒ–ãªã‚‚ã®ã«åˆ†åˆ¥ã™ã‚‹</div>
        <div class="section-content">
          <p>æ›¸ãå‡ºã—ãŸã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯ã‚’èª­ã¿è¿”ã—ã€ãƒã‚¬ãƒ†ã‚£ãƒ–ãªè¨€è‘‰ã‚„è€ƒãˆã‚’è¦‹ã¤ã‘ã‚‹
           </p><p> ãƒã‚¸ãƒ†ã‚£ãƒ–ãªè¨€è‘‰ã‚„è€ƒãˆã‚‚åŒæ§˜ã«è¦‹ã¤ã‘ã‚‹</p>
        </div>
            <div class="section-header">STEP3: ãƒã‚¬ãƒ†ã‚£ãƒ–ãªè‡ªåˆ†ã‚’è‚¯å®šçš„ã«å—ã‘æ­¢ã‚ã‚‹</div>
            <div class="section-content">
              <p>ãƒã‚¬ãƒ†ã‚£ãƒ–ãªè¨€è‘‰ã‚„è€ƒãˆã‚’è¦‹ã¤ã‘ãŸã‚‰ã€ãã‚Œã‚‰ã‚’å¦å®šã›ãšã«å—ã‘æ­¢ã‚ã‚‹
                </p><p>ãƒã‚¬ãƒ†ã‚£ãƒ–ãªè‡ªåˆ†ã‚’è‚¯å®šçš„ã«å—ã‘æ­¢ã‚ã‚‹æ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹</p>
            </div>
          </div>         
            <div class="section-header">STEP4: ç†æƒ³ã®è‡ªåˆ†ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹</div>
            <div class="section-content">
              <p>è‡ªåˆ†ãŒæœ›ã‚€ç†æƒ³ã®å§¿ã‚„çŠ¶æ³ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹
                </p><p>ç†æƒ³ã®è‡ªåˆ†ã«ãªã‚‹ãŸã‚ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚„æ–¹æ³•ã‚’è€ƒãˆã‚‹</p>
            </div>
        <div class="section-header">STEP5: ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹</div>
        <div class="section-content">
          <p>ãƒã‚¸ãƒ†ã‚£ãƒ–ãªè¨€è‘‰ã‚„è€ƒãˆã‚’è¦‹ã¤ã‘ãŸã‚‰ã€ãã‚Œã‚‰ã‚’ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦æ›¸ãå‡ºã™
           </p><p> ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªåˆ†ã«å‘ã‘ã¦ç¹°ã‚Šè¿”ã—è¨€ã†ç·´ç¿’ã‚’ã™ã‚‹</p>
        </div>
      </div>
    </div>
 <!-- è¨­å®šå†…å®¹ -->

<!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->
<h2>ã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯é€ä¿¡æ¬„</h2>
<div>
    åå‰ï¼š<input type="text" id="uname"> 
    æ—¥ä»˜ï¼š<input type="date" id="day">
</div>
<div>
    <textarea id="text" cols="30" rows="10"></textarea>
    <button id="send">é€ä¿¡</button>
</div>
<div id="output" style="overflow: auto;height: auto;"></div>
<!--/ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->

<!-- ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸€è¦§ -->
<h1>Affirmations</h1>
<div class="section-sengen">ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ã€ãªã‚ŠãŸã„è‡ªåˆ†ã‚’æ‰‹ã«å…¥ã‚Œã‚‹ãŸã‚ã®è‡ªå·±å®£è¨€ã®ã“ã¨ã§ã™ã€‚</div>
        <div class="section-sengent">
          <p>ç§ã¯ã™ã§ã«ã€ç†æƒ³ï¼ˆãªã‚ŠãŸã„è‡ªåˆ†ï¼‰ã®çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã€ã¨ã„ã†è‚¯å®šçš„ãªæ–‡ã‚’ç”¨ã„ã¦ã€ç¹°ã‚Šè¿”ã—è‡ªåˆ†è‡ªèº«ã«å®£è¨€ã—ã¾ã™ã€‚
            </p>
            <p>ãã†ã™ã‚‹ã“ã¨ã§ã€è‡ªåˆ†ã®æ½œåœ¨æ„è­˜ã«åƒãã‹ã‘ã€è‡ªå·±è‚¯å®šæ„Ÿã¨è‡ªå°Šå¿ƒã®å¼·åŒ–ã‚’ãŠã“ãªã„ã€è‡ªåˆ†ã®ç†æƒ³ã®çŠ¶æ…‹ã‚’å¶ãˆã¦ã„ãã¾ã™</p>
            <p>ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯å‰Šé™¤ãŒå¯èƒ½ã§ã™</p>
        </div>

<!-- ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸€è¦§ã®æ¬„ -->
<div id="affirmationListContainer">
    <ul id="affirmationList"></ul>
</div>

<!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å—ã‘ä»˜ã‘ã‚‹ãƒ•ã‚©ãƒ¼ãƒ  -->
<h2>ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é€ä¿¡æ¬„</h2>
<div>
    <input type="text" id="newAffirmation" placeholder="æ–°ã—ã„ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å…¥åŠ›">
    <button id="addAffirmation">è¿½åŠ </button>
</div>

<div class="section-sengen">å¿ƒç†çš„å®‰å…¨æ€§ã®æ‹…ä¿ã«ã¤ã„ã¦</div>
        <div class="section-sengent">
          <p>ã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯ã¯ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®èª°ã‚‚ãŒç™ºä¿¡ã§ãã¾ã™
            </p>
            <p>ã‚¢ãƒ•ã‚¡ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯è‡ªåˆ†ã«ã ã‘è¦‹ã‚Œã¾ã™</p>
            <p>ç„¡æ„è­˜ã«èµ·ã“ã‚‹ã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯ã‚’å¤‰ãˆã‚‹ã“ã¨ã¯é›£ã—ãã†ã§ã™ãŒã€æ„è­˜çš„ã«ã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã§ã€è€ƒãˆæ–¹ã®ã‚¯ã‚»ã‚’å¤‰ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
            
        </div>
        <a href="home.php">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>

<!-- JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!--** ä»¥ä¸‹Firebase **-->
<script type="module">
    // Import the functions you need from the SDKs you need
    // Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
import { getDatabase, ref, push, set, update, remove, onChildAdded, onChildChanged, onChildRemoved }
from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";
    
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyApiys7KPXh3WlPtWkAimEd8dRJKVVeY7k",
      authDomain: "self-coath.firebaseapp.com",
      databaseURL: "https://self-coath-default-rtdb.firebaseio.com",
      projectId: "self-coath",
      storageBucket: "self-coath.appspot.com",
      messagingSenderId: "375259169680",
      appId: "1:375259169680:web:f510004f6764f128542915",
      measurementId: "G-3JB40K3NG4"
    };
    
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db  = getDatabase(app);//RealtimeDBã«æ¥ç¶š
    const dbRef = ref(db, "chat");//RealtimeDBå†…ã®"chat"ã‚’ä½¿ã†


    // é€ä¿¡
$("#send").on("click", function () {
    const msg = {
        uname: $("#uname").val(),
        // day: $("#day").val(),
        text: $("#text").val(),
        datetime: formattedDateTime // æŒ‡å®šã—ãŸå½¢å¼ã§æ—¥æ™‚ã‚’è¿½åŠ 
        // datetime: new Date().toISOString() // ç¾åœ¨ã®æ—¥æ™‚ã‚’ISOå½¢å¼ã§å–å¾—ã—ã€datetimeãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«è¿½åŠ 
    }
    // console.log(msg); //ãƒã‚§ãƒƒã‚¯ã—ãŸã‚‰æ¶ˆã™
    const newPostRef = push(dbRef); // ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼ã‚’ç”Ÿæˆ
    set(newPostRef, msg); // "chat"ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯KEYã‚’ã¤ã‘ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²
    console.log(newPostRef);//ã“ã‚Œã‚’ã¿ãŸã‚‰ã€ã©ã†ã„ã†å‡¦ç†ãªã‚“ã‹ã‚ã‹ã‚‹ï¼
});

    // å—è¨º
    // ã‚«ãƒ†ã‚´ãƒªãƒ¼æƒ…å ±ã‚’å—ä¿¡ã™ã‚‹
    onChildAdded(dbRef, function (data) {
    const msg = data.val();
    const key = data.key; // ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼
    let h = '<p id="' + key + '">'; // ã‚«ãƒ†ã‚´ãƒªãƒ¼æƒ…å ±ã¯ã“ã“ã§ã¯ä½¿ç”¨ã—ãªã„
    h += msg.uname + " ";
    if (msg.datetime) { // datetime ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿æ™‚é–“ã‚’è¡¨ç¤º
        h += msg.datetime + " ";
    }
    h += '<span contentEditable="true" id="' + key + '_update">' + msg.text + '</span>';
    h += '<span class="remove" data-key="' + key + '">ğŸš®</span>';
    h += '<span class="update" data-key="' + key + '">ğŸ†™</span>';
    h += '</p>';
    $("#output").prepend(h);
});

// å‰Šé™¤ã‚¤ãƒ™ãƒ³ãƒˆ
$("#output").on("click", ".remove", function () {
    const key = $(this).attr("data-key");
    const remove_item = ref(db, "chat/" + key); // å‚ç…§å…ˆã‚’ä¿®æ­£
    remove(remove_item); //Firebaseãƒ‡ãƒ¼ã‚¿å‰Šé™¤é–¢æ•°
});

// æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆ
$("#output").on("click", ".update", function () {
    const key = $(this).attr("data-key");
    update(ref(db, "chat/" + key), {
        text: $("#" + key + '_update').html()
    });
});

// å‰Šé™¤å‡¦ç†ãŒFirebaseå´ã§å®Ÿè¡Œã•ã‚ŒãŸã‚‰
onChildRemoved(dbRef, (data) => {
    $("#" + data.key).remove(); //DOMæ“ä½œé–¢æ•°ï¼ˆå¯¾è±¡ã‚’å‰Šé™¤ï¼‰
});

// æ›´æ–°å‡¦ç†ãŒFirebaseå´ã§å®Ÿè¡Œã•ã‚ŒãŸã‚‰ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿï¼
onChildChanged(dbRef, (data) => {
    $("#" + data.key + '_update').html(data.val().text);
    $("#" + data.key + '_update').fadeOut(800).fadeIn(800);
});

const currentDate = new Date();
const year = currentDate.getFullYear();
const month = String(currentDate.getMonth() + 1).padStart(2, '0');
const day = String(currentDate.getDate()).padStart(2, '0');
const hours = String(currentDate.getHours()).padStart(2, '0');
const minutes = String(currentDate.getMinutes()).padStart(2, '0');
const seconds = String(currentDate.getSeconds()).padStart(2, '0');
const formattedDateTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
<a href="home.php">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>

</script>

<script src="chat.js"></script>
<footer>   
    <small>MARUMARK</small>
</footer>
</body>
</html>















